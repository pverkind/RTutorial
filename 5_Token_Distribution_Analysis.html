<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>R Tutorial: Token Distribution Analysis</title>

<script src="5_Token_Distribution_Analysis_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="5_Token_Distribution_Analysis_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="5_Token_Distribution_Analysis_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="5_Token_Distribution_Analysis_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="5_Token_Distribution_Analysis_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="5_Token_Distribution_Analysis_files/navigation-1.1/tabsets.js"></script>
<link href="5_Token_Distribution_Analysis_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="5_Token_Distribution_Analysis_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">R Tutorial: Token Distribution Analysis</h1>

</div>


<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This tutorial is based on Jockers’ <em>Text Analysis with R For Students of Literature</em>, Chapter 5: “Token Distribution Analysis”.</p>
<p>This chapter introduces two very important concepts in programming:</p>
<ul>
<li><code>for</code> loops</li>
<li><code>if</code> conditionals</li>
</ul>
</div>
<div id="cleaning-the-workspace" class="section level2">
<h2>Cleaning the Workspace</h2>
<p>RStudio keeps track of all variables you have instantiated during a session (by running an R script, or running code in the RStudio console).</p>
<p>You can see these variables in the <code>Environment</code> tab. These variables remain available in memory, even after you have closed an R script; when you have multiple R script open at the same time in RStudio, variables you have declared in one script will be available for another script in the same session.</p>
<p>This may lead to considerable problems because of variable conflicts (variables with the same name declared in different scripts, for example).</p>
<p>It is a good idea to clean your workspace from time to time. In the RStudio menu, go to <code>Session &gt; Clear Workspace...</code> and click OK.</p>
<p>NB: you can also do this from the RStudio console, by using this command:</p>
<pre><code>&gt; rm(list = ls())</code></pre>
<p>The <code>ls()</code> function (short for “list”) lists all objects R has currently loaded in memory and returns them as a character vector; the <code>rm()</code> function (short for “remove”) removes these items from memory.</p>
<p>If you run the <code>ls()</code> command after removing all objects, you should get the output <code>character(0)</code>, which is R’s way of saying that <code>ls()</code> returned an empty character vector - no variables have been declared in the current session.</p>
<pre><code>&gt; ls()
character(0)
&gt; a &lt;- 123
&gt; ls()
[1] &quot;a&quot;</code></pre>
</div>
<div id="start-up-code" class="section level2">
<h2>Start up code</h2>
<p>We will start this session with loading all lines of text in al-Ṭabari’s History into memory (without the metadata header) from the OpenITI website. We will also load the <code>stringr</code> package for dealing with regular expressions.</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6IiMgbWFrZSBzdXJlIEFyYWJpYyBpcyBkaXNwbGF5ZWQgY29ycmVjdGx5OiBcblN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIikiLCJzYW1wbGUiOiJsaWJyYXJ5KFwic3RyaW5nclwiKSAgIyBpbXBvcnRpbmcgbGlicmFyaWVzIGlzIGFsd2F5cyBkb25lIGF0IHRoZSB0b3Agb2YgYSBzY3JpcHRcblxudXJsIDwtIFwiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL09wZW5JVEkvMDMyNUFIL21hc3Rlci9kYXRhLzAzMTBUYWJhcmkvMDMxMFRhYmFyaS5UYXJpa2gvMDMxMFRhYmFyaS5UYXJpa2guU2hhbWVsYTAwMDk3ODNCSzEtYXJhMS5jb21wbGV0ZWRcIlxudGV4dF92IDwtIHNjYW4odXJsLCB3aGF0PVwiY2hhcmFjdGVyXCIsIHNlcD1cIlxcblwiLCBlbmNvZGluZz1cIlVURi04XCIpXG5zcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxubGluZXNfdiA8LSB0ZXh0X3ZbKHNwbGl0dGVyX2luZGV4KzEpOmxlbmd0aCh0ZXh0X3YpXSJ9
</div>
<p>NB: if you run this code in RStudio, and have not yet installed the <code>stringr</code> package on your computer, you will get an error message. You will have to install <code>stringr</code> and then run the code again.</p>
<p><code>stringr</code> is part of the <a href="https://www.tidyverse.org/">tidyverse</a>, a collection of R packages for data science that work together well because they share the same philosophy, grammar and data structures.</p>
<p>To install all packages of the tidyverse, simply run:</p>
<pre><code>&gt; install.packages(&quot;tidyverse&quot;)</code></pre>
<p>This will install all packages in the tidyverse collection, including <code>stringr</code>.</p>
<p>Remember, a package needs to be installed only once; but in every session you want to use that package, you need to load it using the <code>library()</code> function.</p>
</div>
<div id="algorithm-building" class="section level2">
<h2>Algorithm building</h2>
<p>The practical task this chapter wants to accomplish is to build a graph that shows the frequency of a specific token in each chapter of our example text. In the previous chapters, we already created a plot that allowed us to see the dispersion of a token across the whole text, this time we will add a level of complexity (and, hopefully, new possibilities for finding relevant patterns) by taking chapter boundaries into account.</p>
<p>In order to write a script that does this, we have to turn it into an <strong>algorithm</strong>, that means, we have to break down our main task into smaller steps that can be carried out by the computer.</p>
<p>A good way to start doing this, is by trying to think what steps the computer would need to do to reach our goal.</p>
<p>In our example, this could be a start:</p>
<ul>
<li>load the text</li>
<li>cut the text up into chapters</li>
<li>for every chapter, count the number of times our word is mentioned in that chapter</li>
<li>plot the counts in a graph</li>
</ul>
<p>This is a good start, but now we have to turn these steps into instructions R will understand.</p>
<p>Let’s look at each of these steps in some more detail:</p>
<ul>
<li><p>loading the text: we already know how to instruct R to do this:</p>
<pre><code>url &lt;- &quot;https://raw.githubusercontent.com/OpenITI/0325AH/master/data/0310 Tabari/0310Tabari.Tarikh/0310Tabari.Tarikh.Shamela0009783BK1-ara1.completed&quot;
text_v &lt;- scan(url, what=&quot;character&quot;, sep=&quot;\n&quot;, encoding=&quot;UTF-8&quot;)</code></pre></li>
<li><p>cut the text up into chapters: this is more difficult. We’ll have to break this step into smaller steps:</p>
<ul>
<li>in order to cut the text into chapters, R needs to know where a chapter starts and ends. In the previous chapters, we have already used a regular expression to find the index location of the splitter that splits the metadata header off from the body of the text; we can probably do something similar to find the index location of the start of each chapter. The end of each chapter should be the line before the start of the next chapter (except for the last chapter, where it will be the end of the book), so that should also not be too difficult to do. We’ll discuss how we are going to do this in detail below.</li>
<li>we have already learned how we can use numeric indexing to extract slices from a vector; we will be able to use the start and end index of each chapter to define the start and end point of our slices: <code>chapter_lines_v &lt;- text_lines_v[chapter_start:chapter_end]</code></li>
</ul></li>
<li><p>for every chapter, count the number of times our word is mentioned in that chapter:</p>
<ul>
<li><p>the computer will need to follow the same instructions for each chapter. Since programmers are lazy (and time is valuable), we will not write the same code for every chapter, but tell the computer to execute the same code for every chapter. This is called a <strong>loop</strong> in programming: you tell the computer to run the same code for a defined number of times (or until a specific desired endpoint is reached).</p>
<p>This is an example of a loop that prints a little conversation about three types of fruit:</p></li>
</ul></li>
</ul>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJmcnVpdF92IDwtIGMoXCJhcHBsZXNcIiwgXCJwZWFyc1wiLCBcImJhbmFuYXNcIilcbmZvciAoaSBpbiAoMTpsZW5ndGgoZnJ1aXRfdikpKSB7XG4gIG1lc3NhZ2UoXCJEbyB5b3UgbGlrZSBcIiwgZnJ1aXRfdltpXSwgXCI/XCIpXG4gIG1lc3NhZ2UoXCJJIGxvdmUgXCIsIGZydWl0X3ZbaV0sIFwiIVwiKVxufSJ9
</div>
<ul>
<li><p>There are a couple of different types of loops in R; the one in the example is called a <strong>for loop</strong>, because it starts with the operator <code>for</code>. We will discuss for loops below in detail; for now it suffices to know that a for loop will run the code between the curly brackets a fixed amount of times. In the example, it ran as many times as the <code>fruit_v</code> vector contains elements; for our purposes, we will run it as many times as we found chapter headings in our text.</p></li>
<li><p>in order to be able to compare the frequency for our word in each chapter, even if some chapters are really long, and others very short, it would make sense to use relative frequencies instead of absolute frequencies.</p></li>
</ul>
<blockquote>
<p>NB: the <strong><code>message()</code></strong> function is a useful function for printing information to the console. It can help understand what your script is doing exactly, especially when your script is not producing the output you expect. The function takes any number of character vectors (or other objects that can be converted implicitly to character vectors), concatenates them without any separator, and prints them to the console.</p>
</blockquote>
<blockquote>
<p>A similar function is <code>cat()</code>, which does the same but adds a user-defined separator (<code>sep</code>, default is " " (space)) between each element. The downside of <code>cat()</code> is that you have to add a new-line character as the last element in the list of arguments, otherwise the next output will appear on the same line.</p>
</blockquote>
<pre><code>&gt; a &lt;- c(1, 23, 4)
&gt; cat(&quot;a:&quot;, a)
a: 1 23 4
&gt; cat(&quot;a:&quot;, a, sep = &quot;-&quot;)
a:-1-23-4</code></pre>
</div>
<div id="identifying-chapter-breaks-with-grep" class="section level2">
<h2>Identifying chapter breaks with <code>grep</code></h2>
<p><code>grep</code> is one of the most commonly used functions in R for text analysis, because it leverages the power of regular expressions.</p>
<p><code>grep</code> is used to identify which items in a vector match a (regular expression) pattern. For example, try running this code:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJ0ZXN0X3YgPC0gYyhcIkludHJvZHVjdGlvblwiLCBcIkNIQVBURVIgMS4gTG9vbWluZ3NcIiwgXCJCbGFibGEgYmxhYmxhXCIsIFwiQ0hBUFRFUiAyLiBUaGUgQ2FycGV0LUJhZy5cIilcbmdyZXAoXCJeQ0hBUFRFUiBcXFxcZCtcIiwgdGVzdCkifQ==
</div>
<p>We created a character vector with four elements and assigned it to variable <code>test_v</code>; and we then used <code>grep</code> to identify which of the items in <code>test_v</code> matched a pattern (the upper-case word CHAPTER at the beginning of a string, followed by a space and at least one number). <code>grep</code> returned a vector containing two numbers, indicating that it found two matches of the pattern in the <code>test_v</code> vector: items number two and 4.</p>
<p>We will now use <code>grep</code> to identify the beginning of each chapter in Ṭabari’s History. The text we loaded into memory is from the OpenITI corpus. OpenITI texts contain structural tagging in OpenITI mARkdown format: first-level headings (“chapters”) are introduced with the tag <code>### |</code>, second-level headings with <code>### ||</code>, and so on.</p>
<p>Let’s use <code>grep</code> to find the locations of all section headings in our text:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoXCJzdHJpbmdyXCIpICAjIGltcG9ydGluZyBsaWJyYXJpZXMgaXMgYWx3YXlzIGRvbmUgYXQgdGhlIHRvcCBvZiBhIHNjcmlwdFxuXG4jIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG5TeXMuc2V0bG9jYWxlKGNhdGVnb3J5ID0gXCJMQ19BTExcIiwgbG9jYWxlID0gXCJDLlVURi04XCIpXG5cbnVybCA8LSBcImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9PcGVuSVRJLzAzMjVBSC9tYXN0ZXIvZGF0YS8wMzEwVGFiYXJpLzAzMTBUYWJhcmkuVGFyaWtoLzAzMTBUYWJhcmkuVGFyaWtoLlNoYW1lbGEwMDA5NzgzQksxLWFyYTEuY29tcGxldGVkXCJcbnRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuc3BsaXR0ZXJfaW5kZXggPC0gd2hpY2godGV4dF92ID09IFwiI01FVEEjSGVhZGVyI0VuZCNcIilcbmxpbmVzX3YgPC0gdGV4dF92WyhzcGxpdHRlcl9pbmRleCsxKTpsZW5ndGgodGV4dF92KV0iLCJzYW1wbGUiOiJjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbmhlYWQoY2hhcHRlcl9zdGFydHNfdilcbmhlYWQobGluZXNfdltjaGFwdGVyX3N0YXJ0c192XSwgMjUpIn0=
</div>
</div>
<div id="a-remark-on-grep-with-non-latin-characters-on-windows" class="section level2">
<h2>A remark on <code>grep</code> with non-Latin characters on Windows</h2>
<p>Unfortunately, <code>grep</code> does not deal particularly well with Arabic script (and other non-ASCII characters) on Windows (no problem on Mac and Linux, provided the locale is set to a UTF-8 locale).</p>
<p>For example, if we try the same code with an equivalent in Arabic:</p>
<pre><code>&gt; test_v &lt;- c(&quot;المقدمة&quot;, &quot;باب ١&quot;, &quot;بلا بلا&quot;, &quot;باب ٢&quot;)
&gt; grep(&quot;^باب \\d+&quot;, test_v)
integer(0)</code></pre>
<p><code>grep</code> returned <code>integer(0)</code>, which means, an empty numeric vector: <code>grep</code> did not find a match.</p>
<p>We can see why by slightly changing the <code>test_v</code> vector (replacing the hindi-Arabic numbers by ASCII Arabic numbers):</p>
<pre><code>&gt; test_v &lt;- c(&quot;المقدمة&quot;, &quot;باب 1&quot;, &quot;بلا بلا&quot;, &quot;باب 2&quot;)
&gt; grep(&quot;^باب \\d+&quot;, test_v)
[1] 2 4</code></pre>
<p>Clearly, what is going on, is that the special regex character <code>\\d</code> in <code>grep</code> does not cover hindi-Arabic numerals, only ASCII numerals.</p>
<p>The same goes for another important regex character, <code>\\w</code>, which supposedly covers any letter or numeric character:</p>
<pre><code>&gt; test_v &lt;- c(&quot;test&quot;, &quot;عربي&quot;, &quot;فارسی&quot;)
&gt; grep(&quot;\\w+&quot;, test_v)
[1] 1</code></pre>
<p>What is happening is that <code>grep</code> uses the language settings (“locale”) of your operating system, and only matches those characters that are defined there as word characters.</p>
<p>On Mac and Linux, you can use the command <code>Sys.setlocale("LC_ALL", "C.UTF-8")</code> to set your locale encoding to <code>UTF-8</code>, a unicode implementation, which will solve this problem; but on Windows, this is currently not possible.</p>
<p>For this reason, it is better to use the regular expression functions from the <code>stringr</code> package, because those cover all unicode characters by default.</p>
</div>
<div id="for-loops" class="section level2">
<h2>for loops</h2>
<p>A “for loop” is used in programming to repeat the same code a fixed number of times. For loops are often used to “iterate over”, or “loop through”, all items in a vector and repeat the same code for each item.</p>
<p>In our example, we will iterate over the start index of each chapter in our book, which we stored in the variable <code>chapter_starts_v</code>.</p>
<p>One popular way to do this is by looping through the index positions of each item in the vector, starting from the first (item number 1) to the last item (<code>length(chapter_starts_v)</code>). Inside the loop’s code block (that is, the code between the curly braces that will be repeated for each item in the vector), you can then access each item’s value by numeric indexing (<code>chapter_starts_v[i]</code>):</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIG1lc3NhZ2UoXCJjaGFwdGVyIFwiLCBpLCBcIiBzdGFydHMgYXQgaW5kZXggbnVtYmVyIFwiLCBjaGFwdGVyX3N0YXJ0KVxufSJ9
</div>
<p>Note the indentation in the code above: in R, code inside a code block is indented by two spaces, for readability: this makes it easier to see which part of the code is part of the code block and will thus be repeated in every step of the loop.</p>
<p>The first line of the for loop creates a variable <code>i</code>, whose value will change in every step (“iteration”) of the for loop. The first time, <code>i</code> will have the value 1, the second time 2, and so on until it reaches the last number in the sequence <code>1:length(chapter_starts_v)</code>.</p>
<p>The loop as written above is thus a short way of writing:</p>
<pre><code>i &lt;- 1
chapter_start &lt;- chapter_starts_v[i]
message(&quot;chapter &quot;, i, &quot; starts at index number &quot;, chapter_start)
i &lt;- 2
chapter_start &lt;- chapter_starts_v[i]
message(&quot;chapter &quot;, i, &quot; starts at index number &quot;, chapter_start)
i &lt;- 3
chapter_start &lt;- chapter_starts_v[i]
message(&quot;chapter &quot;, i, &quot; starts at index number &quot;, chapter_start)
...
i &lt;- length(chapter_starts_v)
chapter_start &lt;- chapter_starts_v[i]
message(&quot;chapter &quot;, i, &quot; starts at index number &quot;, chapter_start)</code></pre>
<p>One of the advantages of looping through a vector in this way is that it becomes possible to access in every step of the looping process not only the current item’s value (<code>chapter_starts_v[i]</code>) but also the next item’s value (<code>chapter_starts_v[i+1]</code>).</p>
<p>We will use this in our code to define the index number of the end of each chapter. Since our text vector <code>lines_v</code> contains lines of text, the end of each chapter can be defined as the line before the start of the next chapter:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIG5leHRfY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2krMV1cbiAgY2hhcHRlcl9lbmQgPC0gbmV4dF9jaGFwdGVyX3N0YXJ0IC0gMVxuICBtZXNzYWdlKFwiQ2hhcHRlciBcIiwgaSwgXCIgc3RhcnRzIGF0IGxpbmUgXCIsIGNoYXB0ZXJfc3RhcnQsIFwiIGFuZCBlbmRzIGF0IGxpbmUgXCIsIGNoYXB0ZXJfZW5kKVxufSJ9
</div>
<p>If you run this code, it will print a message about the start and end of each chapter. For the last chapter, however, it will produce an error: instead of a number, the output says that the chapter “ends at index NA”. <code>NA</code> is a special value in R that means “Not Available”; that is because we defined the <code>chapter_end</code> as the last line before the next chapter, and for the last chapter, the book does not have a next chapter.</p>
<p>To deal with such cases, additional <strong>conditions</strong> are often added to for loops. In our case, we would like to use the code we wrote above to define the end index of each chapter except the last chapter.</p>
<p>We can write that condition like this:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICAgIG1lc3NhZ2UoXCJDaGFwdGVyIFwiLCBpLCBcIiBzdGFydHMgYXQgbGluZSBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgbGluZSBcIiwgY2hhcHRlcl9lbmQpXG4gIH1cbn0ifQ==
</div>
<p>Conditions start with the operator <code>if</code>; the condition itself is written between brackets, and the code that needs to be executed if the condition is met, is written in a code block, between braces.</p>
<blockquote>
<p>Note that the condition has the same syntax as the for loop itself: <code>&lt;operator&gt; &lt;bracketed expression&gt; &lt;indented code block between braces&gt;</code>. Note also that the <code>if</code> code block is indented by 4 spaces, 2 more than the <code>for</code> code block it belongs to, again for readability.</p>
</blockquote>
<p>If you run the code above, you will see that its output is almost identical to the code we wrote before. The only difference is that it did not print the start and end index info for the last chapter, because the last chapter did fulfill the condition of the <code>if</code> statement.</p>
<p>For cases that do not fulfill the condition of the <code>if</code> statement, we can define alternative code to be run in another code block, that is preceded by the <code>else</code> operator. For the last chapter, we would like to use the end of the book as the end of the chapter:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICAgIG1lc3NhZ2UoXCJDaGFwdGVyIFwiLCBpLCBcIiBzdGFydHMgYXQgbGluZSBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgbGluZSBcIiwgY2hhcHRlcl9lbmQpXG4gIH1cbiAgZWxzZSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gbGVuZ3RoKGxpbmVzX3YpXG4gICAgbWVzc2FnZShcIkNoYXB0ZXIgXCIsIGksIFwiIHN0YXJ0cyBhdCBsaW5lIFwiLCBjaGFwdGVyX3N0YXJ0LCBcIiBhbmQgZW5kcyBhdCBsaW5lIFwiLCBjaGFwdGVyX2VuZClcbiAgfVxufSJ9
</div>
<p>If you run this code, you will see that it correctly prints the start and end indexes of each chapter, including the last chapter.</p>
<p>Using numeric indexing, we can now use the indexes stored in the <code>chapter_start</code> and <code>chapter_end</code> variables to extract the lines of each chapter from the <code>lines_v</code> (the latter contains all lines of the text):</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICB9XG4gIGVsc2Uge1xuICAgIGNoYXB0ZXJfZW5kIDwtIGxlbmd0aChsaW5lc192KVxuICB9XG4gIG1lc3NhZ2UoXCJDaGFwdGVyIFwiLCBpLCBcIiBzdGFydHMgYXQgbGluZSBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgbGluZSBcIiwgY2hhcHRlcl9lbmQpXG4gIGNoYXB0ZXJfbGluZXNfdiA8LSBsaW5lc192W2NoYXB0ZXJfc3RhcnQ6Y2hhcHRlcl9lbmRdXG4gIG1lc3NhZ2UoaGVhZChjaGFwdGVyX2xpbmVzX3YsIDEwKSlcbn0ifQ==
</div>
<p>Finally, we can count the number of times our token is mentioned in the chapter text. We can use the <code>str_count</code> function from the <code>stringr</code> package to do this; <code>str_count(vector, pattern)</code> counts for every item in a vector how often the search pattern is found in it.</p>
<p>For example, run this code to count the vowels in each item in the <code>test_v</code> vector:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJsaWJyYXJ5KFwic3RyaW5nclwiKVxudGVzdF92IDwtIGMoXCJ0ZXN0XCIsIFwidmVjdG9yXCIsIFwiZHNuJ3QgY250biB2d2xzXCIpXG5zdHJfY291bnQodGVzdF92LCBcIlthZWlvdV1cIikifQ==
</div>
<p>In order to count all vowels in all items in the <code>test_v</code> vector combined, we need to sum the results of <code>str_count</code>:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJsaWJyYXJ5KFwic3RyaW5nclwiKVxudGVzdF92IDwtIGMoXCJ0ZXN0XCIsIFwidmVjdG9yXCIsIFwiZHNuJ3QgY250biB2d2xzXCIpXG5zdW0oc3RyX2NvdW50KHRlc3RfdiwgXCJbYWVpb3VdXCIpKSJ9
</div>
<p>Let’s use this function to count the number of times the transmissive term ḥaddathanī/ā is mentioned in the chapter:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgIyBkZWZpbmUgdGhlIHN0YXJ0IGFuZCBlbmQgaW5kZXggb2YgZXZlcnkgY2hhcHRlcjpcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICB9XG4gIGVsc2Uge1xuICAgIGNoYXB0ZXJfZW5kIDwtIGxlbmd0aChsaW5lc192KVxuICB9XG4gbWVzc2FnZShcImNoYXB0ZXIgXCIsIGksIFwiIHN0YXJ0cyBhdCBpbmRleCBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgaW5kZXggXCIsIGNoYXB0ZXJfZW5kKVxuICBcbiAgIyBleHRyYWN0IHRoZSBjaGFwdGVyIHRleHQgZnJvbSB0aGUgd2hvbGUgdGV4dDogXG4gIGNoYXB0ZXJfbGluZXNfdiA8LSBsaW5lc192W2NoYXB0ZXJfc3RhcnQ6Y2hhcHRlcl9lbmRdXG4gIFxuICAjIGNvdW50IHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHNlYXJjaCBwYXR0ZXJuIGlzIG1lbnRpb25lZCBpbiB0aGUgY2hhcHRlcjpcbiAgIyMgISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIVxuICAjIGZpbGwgaW4gdGhlIHBhdHRlcm4gaGVyZTogXG4gIHB0cm4gPC0gXCJeIyAuP1x1MDYyZFx1MDYyZlx1MDYyYlx1MDY0NlwiXG4gIGNoYXB0ZXJfY291bnQgPC0gc3VtKHN0cl9jb3VudChjaGFwdGVyX2xpbmVzX3YsIHB0cm4pKVxuICBtZXNzYWdlKFwiQ2hhcHRlciBcIiwgaSwgXCIgY29udGFpbnMgdGhlIHNlYXJjaCBwYXR0ZXJuIFwiLCBjaGFwdGVyX2NvdW50LCBcIiB0aW1lc1wiKVxuXG59In0=
</div>
<p>Since the text contains long and short chapters, it makes sense to use a relative count rather than the absolute count. We could, for example, check what percentage of the lines in each chapter contain the search term:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiJmb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgIyBkZWZpbmUgdGhlIHN0YXJ0IGFuZCBlbmQgaW5kZXggb2YgZXZlcnkgY2hhcHRlcjpcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICB9XG4gIGVsc2Uge1xuICAgIGNoYXB0ZXJfZW5kIDwtIGxlbmd0aChsaW5lc192KVxuICB9XG4gbWVzc2FnZShcImNoYXB0ZXIgXCIsIGksIFwiIHN0YXJ0cyBhdCBpbmRleCBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgaW5kZXggXCIsIGNoYXB0ZXJfZW5kKVxuICBcbiAgIyBleHRyYWN0IHRoZSBjaGFwdGVyIHRleHQgZnJvbSB0aGUgd2hvbGUgdGV4dDogXG4gIGNoYXB0ZXJfbGluZXNfdiA8LSBsaW5lc192W2NoYXB0ZXJfc3RhcnQ6Y2hhcHRlcl9lbmRdXG4gIFxuICAjIGNvdW50IHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHNlYXJjaCBwYXR0ZXJuIGlzIG1lbnRpb25lZCBpbiB0aGUgY2hhcHRlcjpcbiAgIyMgISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIVxuICAjIGZpbGwgaW4gdGhlIHBhdHRlcm4gaGVyZTogXG4gIHB0cm4gPC0gXCJeIyAuP1x1MDYyZFx1MDYyZlx1MDYyYlx1MDY0NlwiXG4gIGNoYXB0ZXJfY291bnQgPC0gc3VtKHN0cl9jb3VudChjaGFwdGVyX2xpbmVzX3YsIHB0cm4pKVxuICBtZXNzYWdlKFwiQ2hhcHRlciBcIiwgaSwgXCIgY29udGFpbnMgdGhlIHNlYXJjaCBwYXR0ZXJuIFwiLCBjaGFwdGVyX2NvdW50LCBcIiB0aW1lc1wiKVxuXG4gICMgY29udmVydCB0aGlzIGFic29sdXRlIGNvdW50IGludG8gYSByZWxhdGl2ZSBjb3VudDogXG4gIHJlbGF0aXZlX2NoYXB0ZXJfY291bnQgPC0gMTAwICogY2hhcHRlcl9jb3VudCAvIGxlbmd0aChjaGFwdGVyX2xpbmVzX3YpXG4gIG1lc3NhZ2UocmVsYXRpdmVfY2hhcHRlcl9jb3VudCwgXCIlIG9mIGxpbmVzIGluIENoYXB0ZXIgXCIsIGksIFwiIGNvbnRhaW4gdGhlIHNlYXJjaCBwYXR0ZXJuIFwiKVxuXG59In0=
</div>
<p>Time to celebrate! We managed to print the data we wanted to extract from each chapter!</p>
<p>But wait, we also wanted to plot this data in a graph. How can we do that? The <code>relative_chapter_count</code> variable is created anew in every step of the loop; at the end of the loop, it contains only the count for the last chapter.</p>
<p>The solution is to create, before we start the loop, a vector into which we will store the counts for every chapter:</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59XG5cbmlmICghIChleGlzdHMoXCJjaGFwdGVyX3N0YXJ0c192XCIpKSkge1xuICBjaGFwdGVyX3N0YXJ0c192IDwtIGdyZXAoXCIjIyMgXFxcXHxcXFxcfCBcIiwgbGluZXNfdilcbn0iLCJzYW1wbGUiOiIjIGluaXRpYWxpemUgYW4gZW1wdHkgdmVjdG9yIHRoYXQgd2lsbCBob2xkIHRoZSBjb3VudHMgZm9yIGV2ZXJ5IGNoYXB0ZXI6IFxucmVsYXRpdmVfY2hhcHRlcl9jb3VudHMgPC0gYygpXG5cbmZvciAoaSBpbiAxOmxlbmd0aChjaGFwdGVyX3N0YXJ0c192KSkge1xuICAjIGRlZmluZSB0aGUgc3RhcnQgYW5kIGVuZCBpbmRleCBvZiBldmVyeSBjaGFwdGVyOlxuICBjaGFwdGVyX3N0YXJ0IDwtIGNoYXB0ZXJfc3RhcnRzX3ZbaV1cbiAgaWYgKGkgPCBsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgICBjaGFwdGVyX2VuZCA8LSBjaGFwdGVyX3N0YXJ0c192W2krMV0gLSAxXG4gIH1cbiAgZWxzZSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gbGVuZ3RoKGxpbmVzX3YpXG4gIH1cbiBtZXNzYWdlKFwiY2hhcHRlciBcIiwgaSwgXCIgc3RhcnRzIGF0IGluZGV4IFwiLCBjaGFwdGVyX3N0YXJ0LCBcIiBhbmQgZW5kcyBhdCBpbmRleCBcIiwgY2hhcHRlcl9lbmQpXG4gIFxuICAjIGV4dHJhY3QgdGhlIGNoYXB0ZXIgdGV4dCBmcm9tIHRoZSB3aG9sZSB0ZXh0OiBcbiAgY2hhcHRlcl9saW5lc192IDwtIGxpbmVzX3ZbY2hhcHRlcl9zdGFydDpjaGFwdGVyX2VuZF1cbiAgXG4gICMgY291bnQgdGhlIG51bWJlciBvZiB0aW1lcyB0aGUgc2VhcmNoIHBhdHRlcm4gaXMgbWVudGlvbmVkIGluIHRoZSBjaGFwdGVyOlxuICAjIyAhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhXG4gICMgZmlsbCBpbiB0aGUgcGF0dGVybiBoZXJlOiBcbiAgcHRybiA8LSBcIl4jIC4/XHUwNjJkXHUwNjJmXHUwNjJiXHUwNjQ2XCJcbiAgY2hhcHRlcl9jb3VudCA8LSBzdW0oc3RyX2NvdW50KGNoYXB0ZXJfbGluZXNfdiwgcHRybikpXG4gIG1lc3NhZ2UoXCJDaGFwdGVyIFwiLCBpLCBcIiBjb250YWlucyB0aGUgc2VhcmNoIHBhdHRlcm4gXCIsIGNoYXB0ZXJfY291bnQsIFwiIHRpbWVzXCIpXG5cbiAgIyBjb252ZXJ0IHRoaXMgYWJzb2x1dGUgY291bnQgaW50byBhIHJlbGF0aXZlIGNvdW50OiBcbiAgcmVsYXRpdmVfY2hhcHRlcl9jb3VudCA8LSAxMDAgKiBjaGFwdGVyX2NvdW50IC8gbGVuZ3RoKGNoYXB0ZXJfbGluZXNfdilcbiAgbWVzc2FnZShyZWxhdGl2ZV9jaGFwdGVyX2NvdW50LCBcIiUgb2YgbGluZXMgaW4gQ2hhcHRlciBcIiwgaSwgXCIgY29udGFpbiB0aGUgc2VhcmNoIHBhdHRlcm4gXCIpXG4gIFxuICAjIGFkZCB0aGUgY3VycmVudCBjb3VudCB0byB0aGUgdmVjdG9yIGNvbnRhaW5pbmcgYWxsIGNvdW50czogXG4gIHJlbGF0aXZlX2NoYXB0ZXJfY291bnRzW2ldIDwtIHJlbGF0aXZlX2NoYXB0ZXJfY291bnRcbiAgbWVzc2FnZShyZWxhdGl2ZV9jaGFwdGVyX2NvdW50cylcbiAgXG59XG5cbnBsb3QocmVsYXRpdmVfY2hhcHRlcl9jb3VudHMsIHR5cGUgPSBcImhcIikifQ==
</div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>OpenITI texts contain so-called “milestones” after each sequence of 300 Arabic tokens. They consist of the characters “ms” followed by a number. Try to create a graph like the one we created for the chapter for each milestone. Since the sections are all 300 tokens long, we don’t need relative counts but we can use the absolute counts</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmKCEgKFwic3RyaW5nclwiICVpbiUgKC5wYWNrYWdlcygpKSkpIGxpYnJhcnkoXCJzdHJpbmdyXCIpXG5cbmlmICghIChleGlzdHMoXCJsaW5lc192XCIpKSkge1xuICAjIG1ha2Ugc3VyZSBBcmFiaWMgaXMgZGlzcGxheWVkIGNvcnJlY3RseTogXG4gIFN5cy5zZXRsb2NhbGUoY2F0ZWdvcnkgPSBcIkxDX0FMTFwiLCBsb2NhbGUgPSBcIkMuVVRGLThcIilcblxuICB1cmwgPC0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vT3BlbklUSS8wMzI1QUgvbWFzdGVyL2RhdGEvMDMxMFRhYmFyaS8wMzEwVGFiYXJpLlRhcmlraC8wMzEwVGFiYXJpLlRhcmlraC5TaGFtZWxhMDAwOTc4M0JLMS1hcmExLmNvbXBsZXRlZFwiXG4gIHRleHRfdiA8LSBzY2FuKHVybCwgd2hhdD1cImNoYXJhY3RlclwiLCBzZXA9XCJcXG5cIiwgZW5jb2Rpbmc9XCJVVEYtOFwiKVxuICBzcGxpdHRlcl9pbmRleCA8LSB3aGljaCh0ZXh0X3YgPT0gXCIjTUVUQSNIZWFkZXIjRW5kI1wiKVxuICBsaW5lc192IDwtIHRleHRfdlsoc3BsaXR0ZXJfaW5kZXgrMSk6bGVuZ3RoKHRleHRfdildXG59Iiwic2FtcGxlIjoiY2hhcHRlcl9zdGFydHNfdiA8LSBncmVwKFwibXNcXFxcZCtcIiwgbGluZXNfdilcblxuIyBpbml0aWFsaXplIGFuIGVtcHR5IHZlY3RvciB0aGF0IHdpbGwgaG9sZCB0aGUgY291bnRzIGZvciBldmVyeSBjaGFwdGVyOiBcbmNoYXB0ZXJfY291bnRzIDwtIGMoKVxuXG5mb3IgKGkgaW4gMTpsZW5ndGgoY2hhcHRlcl9zdGFydHNfdikpIHtcbiAgIyBkZWZpbmUgdGhlIHN0YXJ0IGFuZCBlbmQgaW5kZXggb2YgZXZlcnkgY2hhcHRlcjpcbiAgY2hhcHRlcl9zdGFydCA8LSBjaGFwdGVyX3N0YXJ0c192W2ldXG4gIGlmIChpIDwgbGVuZ3RoKGNoYXB0ZXJfc3RhcnRzX3YpKSB7XG4gICAgY2hhcHRlcl9lbmQgPC0gY2hhcHRlcl9zdGFydHNfdltpKzFdIC0gMVxuICB9XG4gIGVsc2Uge1xuICAgIGNoYXB0ZXJfZW5kIDwtIGxlbmd0aChsaW5lc192KVxuICB9XG4gbWVzc2FnZShcImNoYXB0ZXIgXCIsIGksIFwiIHN0YXJ0cyBhdCBpbmRleCBcIiwgY2hhcHRlcl9zdGFydCwgXCIgYW5kIGVuZHMgYXQgaW5kZXggXCIsIGNoYXB0ZXJfZW5kKVxuICBcbiAgIyBleHRyYWN0IHRoZSBjaGFwdGVyIHRleHQgZnJvbSB0aGUgd2hvbGUgdGV4dDogXG4gIGNoYXB0ZXJfbGluZXNfdiA8LSBsaW5lc192W2NoYXB0ZXJfc3RhcnQ6Y2hhcHRlcl9lbmRdXG4gIFxuICAjIGNvdW50IHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIHNlYXJjaCBwYXR0ZXJuIGlzIG1lbnRpb25lZCBpbiB0aGUgY2hhcHRlcjpcbiAgIyMgISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIVxuICAjIGZpbGwgaW4gdGhlIHBhdHRlcm4gaGVyZTogXG4gIHB0cm4gPC0gXCJeIyAuP1x1MDYyZFx1MDYyZlx1MDYyYlx1MDY0NlwiXG4gIGNoYXB0ZXJfY291bnQgPC0gc3VtKHN0cl9jb3VudChjaGFwdGVyX2xpbmVzX3YsIHB0cm4pKVxuICBtZXNzYWdlKFwiQ2hhcHRlciBcIiwgaSwgXCIgY29udGFpbnMgdGhlIHNlYXJjaCBwYXR0ZXJuIFwiLCBjaGFwdGVyX2NvdW50LCBcIiB0aW1lc1wiKVxuXG4gICMgY29udmVydCB0aGlzIGFic29sdXRlIGNvdW50IGludG8gYSByZWxhdGl2ZSBjb3VudDogXG4gIHJlbGF0aXZlX2NoYXB0ZXJfY291bnQgPC0gMTAwICogY2hhcHRlcl9jb3VudCAvIGxlbmd0aChjaGFwdGVyX2xpbmVzX3YpXG4gIG1lc3NhZ2UocmVsYXRpdmVfY2hhcHRlcl9jb3VudCwgXCIlIG9mIGxpbmVzIGluIENoYXB0ZXIgXCIsIGksIFwiIGNvbnRhaW4gdGhlIHNlYXJjaCBwYXR0ZXJuIFwiKVxuICBcbiAgIyBhZGQgdGhlIGN1cnJlbnQgY291bnQgdG8gdGhlIHZlY3RvciBjb250YWluaW5nIGFsbCBjb3VudHM6IFxuICBjaGFwdGVyX2NvdW50c1tpXSA8LSBjaGFwdGVyX2NvdW50XG59XG5cbnBsb3QoY2hhcHRlcl9jb3VudHMsIHR5cGUgPSBcImhcIikifQ==
</div>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIgICAgZm9yIChpIGluICgxOjUpKSB7XG4gICAgICAgIHByaW50KHBhc3RlKGksIFwiYW5kIDEgZXF1YWxcIiwgKGkgKyAxKSwgc2VwID0gXCIgXCIpKVxuICAgICAgICBwcmludChwYXN0ZShpLCBcImFuZCAzIGVxdWFsXCIsIChpICsgMyksIHNlcCA9IFwiIFwiKSlcbiAgICAgICAgcHJpbnQocGFzdGUoaSwgXCJhbmQgNSBlcXVhbFwiLCAoaSArIDUpLCBzZXAgPSBcIiBcIikpXG4gICAgfSJ9
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
